<!DOCTYPE html>
<html>
<head>
  <title>IPA Signer</title>
</head>
<body>
  <h2>Upload your IPA for Signing</h2>
  
  <!-- Hidden UDID -->
  <input type="hidden" id="udid" value="00008140-000628e82e07801c" />

  <input type="file" id="ipaFile" accept=".ipa" />
  <br><br>

  <button onclick="uploadIPA()">Upload & Sign</button>

  <div id="result" style="margin-top:20px;"></div>

  <script>
    async function uploadIPA() {
      const udid = document.getElementById("udid").value.trim();
      const fileInput = document.getElementById("ipaFile");

      if (fileInput.files.length === 0) {
        alert("Please select an .ipa file.");
        return;
      }

      const formData = new FormData();
      formData.append("udid", udid);
      formData.append("app", fileInput.files[0]);

      try {
        const response = await fetch("https://api.ipasigner.com/sign-app", {
          method: "POST",
          body: formData
        });

        if (!response.ok) {
          document.getElementById("result").innerText = 
            "Upload failed. Status: " + response.status;
          return;
        }

        // This assumes server returns JSON like { install_url, plist_url, ipa_url }
        const data = await response.json();

        document.getElementById("result").innerHTML = `
          <p>âœ… Upload successful!</p>
          <p><a href="${data.install_url}">Install App</a></p>
          <p>Plist: <a href="${data.plist_url}" target="_blank">${data.plist_url}</a></p>
          <p>IPA: <a href="${data.ipa_url}" target="_blank">${data.ipa_url}</a></p>
        `;
      } catch (err) {
        document.getElementById("result").innerText = 
          "Error: " + err.message;
      }
    }
  </script>
</body>
</html>

